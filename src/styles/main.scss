// --- src/styles/main.scss ---

// Layout variables for consistent spacing
:root {
  --navbar-height-mobile: 4rem;
  --navbar-height-desktop: 4.5rem;
  --bottom-nav-height-mobile: 4rem; // For mobile only
}

// 1. Import custom variables first using @use
@use 'variables' as v;
// 8. Import your custom animations using @use
@use 'animations';

// 2. Import Bootstrap functions and default variables
@import "bootstrap/scss/functions";

// 3. --- IMPORTANT: Define Bootstrap variable overrides HERE ---
$primary: v.$primary;
$secondary: v.$secondary;
$success: v.$success;
$info: v.$info;
$warning: v.$warning;
$danger: v.$danger;
$light: v.$light;
$dark: v.$dark;

$body-bg: v.$body-bg;
$body-color: v.$body-color;
$border-color: v.$border-color;
$card-bg: v.$card-bg;
$card-cap-bg: v.$card-cap-bg;
$input-bg: v.$input-bg;
$input-border-color: v.$input-border-color;

$font-family-sans-serif: v.$font-family-sans-serif;
$font-weight-light: v.$font-weight-light;
$font-weight-normal: v.$font-weight-normal;
$font-weight-medium: v.$font-weight-medium;
$font-weight-bold: v.$font-weight-bold;

$border-radius: v.$border-radius;
$border-radius-sm: v.$border-radius-sm;
$border-radius-lg: v.$border-radius-lg;
$border-radius-xl: v.$border-radius-xl; // Uncommented for use

$box-shadow-sm: v.$box-shadow-sm;
$box-shadow: v.$box-shadow;
$box-shadow-lg: v.$box-shadow-lg;

// Typography overrides
$font-size-base: v.$font-size-base;
$h1-font-size: v.$h1-font-size;
$h2-font-size: v.$h2-font-size;
$h3-font-size: v.$h3-font-size;
$h4-font-size: v.$h4-font-size;
$h5-font-size: v.$h5-font-size;
$h6-font-size: v.$h6-font-size;
$headings-font-weight: v.$headings-font-weight;
$headings-line-height: v.$headings-line-height;
$headings-color: v.$headings-color;

// Enable responsive font sizes for automatic scaling
$enable-responsive-font-sizes: true;

// NOTE: If Font Awesome is imported via SCSS, add the import here.
// The $fa-font-formats variable in _variables.scss only affects SCSS imports.

// Map necessary z-indices if Bootstrap requires overrides here
// $z-index-dropdown: map-get(v.$z-indices, dropdown);
// ... other z-indices

// 4. Import remaining Bootstrap core files (using your overrides)
@import "bootstrap/scss/variables";
@import "bootstrap/scss/variables-dark";
@import "bootstrap/scss/maps";
@import "bootstrap/scss/mixins";
@import "bootstrap/scss/utilities";

// 5. Import Layout & Components (Selectively)
@import "bootstrap/scss/root";
@import "bootstrap/scss/reboot";
@import "bootstrap/scss/type";
@import "bootstrap/scss/images";
@import "bootstrap/scss/containers";
@import "bootstrap/scss/grid";
@import "bootstrap/scss/forms";
@import "bootstrap/scss/buttons";
@import "bootstrap/scss/transitions";
@import "bootstrap/scss/dropdown";
@import "bootstrap/scss/button-group";
@import "bootstrap/scss/nav";
@import "bootstrap/scss/navbar";
@import "bootstrap/scss/card";
@import "bootstrap/scss/alert";
@import "bootstrap/scss/progress";
@import "bootstrap/scss/list-group";
@import "bootstrap/scss/close";
@import "bootstrap/scss/modal";
@import "bootstrap/scss/badge";
@import "bootstrap/scss/spinners";
@import "bootstrap/scss/toasts";

// 6. Import Helpers
@import "bootstrap/scss/helpers";

// 7. Import Utilities API last
@import "bootstrap/scss/utilities/api";

// --- Your Customizations ---

// 9. Your custom global styles
html {
  font-size: 100%; // Base for rem units
}

body {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  min-height: 100vh;
  background-color: var(--bs-body-bg); // Use CSS var
  color: var(--bs-body-color); // Use CSS var
  font-family: v.$font-family-sans-serif;
  font-weight: v.$font-weight-normal;
  line-height: 1.6; // Improved readability
}

// Consistent Heading Styles
h1, .h1,
h2, .h2,
h3, .h3,
h4, .h4,
h5, .h5,
h6, .h6 {
  font-family: v.$font-family-sans-serif;
  font-weight: v.$headings-font-weight;
  color: v.$headings-color;
  line-height: v.$headings-line-height;
  margin-bottom: 0.75rem; // Consistent margin
}

// Custom spacing classes for navbar spacing - using CSS variables for dynamic access
.app-main-content {
  // Default for mobile
  padding-top: var(--navbar-height-mobile); 
  // Add a little space at the bottom, plus safe area for notches
  padding-bottom: calc(1rem + env(safe-area-inset-bottom, 0)); 
  overflow-x: hidden;

  // When .has-bottom-nav is present on mobile
  &.has-bottom-nav {
    padding-bottom: calc(var(--bottom-nav-height-mobile) + 1rem + env(safe-area-inset-bottom, 0));
  }

  // Desktop view
  @include media-breakpoint-up(lg) {
    padding-top: var(--navbar-height-desktop);
    padding-bottom: 2rem; // Give some breathing room at the bottom on desktop
    
    // No bottom nav on desktop, so no extra padding needed
    &.has-bottom-nav {
      padding-bottom: 2rem;
    }
  }
}

// Custom viewport height classes - using CSS variables
.min-vh-100-subtract-nav {
  // Mobile calculation
  min-height: calc(100vh - var(--navbar-height-mobile) - var(--bottom-nav-height-mobile));

  // Desktop calculation
  @include media-breakpoint-up(lg) {
    min-height: calc(100vh - var(--navbar-height-desktop));
  }
}

// General style refinements for UI consistency
.card {
  border: 1px solid var(--bs-border-color);
  transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
  &:hover {
    transform: translateY(-3px);
    box-shadow: var(--bs-box-shadow-lg);
  }
}

.btn {
  font-weight: v.$font-weight-medium;
  transition: all 0.2s ease-in-out;
  &:hover { 
    transform: translateY(-2px);
    box-shadow: var(--bs-box-shadow);
  }
  &:active { 
    transform: translateY(0); 
    box-shadow: none;
  }
}

.form-control, .form-select {
  font-size: 0.95rem;
  &:focus {
    border-color: v.$primary;
    box-shadow: 0 0 0 0.25rem rgba(v.$primary, 0.25);
  }
}

.form-label {
  font-weight: v.$font-weight-medium;
  margin-bottom: 0.5rem;
}

.badge {
  font-weight: v.$font-weight-medium;
  padding: 0.4em 0.65em; // Slightly larger for better readability
}

// Your custom utility classes (if needed beyond Bootstrap)
.text-decoration-underline-hover:hover {
  text-decoration: underline !important;
}

.shadow-hover {
  transition: box-shadow 0.2s ease-in-out;
  &:hover {
    box-shadow: var(--bs-box-shadow-lg); // Using CSS variable instead of !important
  }
}

// Using defined variables for custom text classes
.text-vibrant {
  color: v.$primary !important; // Use variable
}

.text-muted {
  color: v.$secondary !important; // Use variable
}

// Using the new variables for accent colors
.text-accent {
  color: v.$teal-accent !important; // Using variable instead of hardcoded color
}

.text-soft {
  color: v.$slate-soft !important; // Using variable instead of hardcoded color
}

// Custom small alert (consider using Bootstrap's default alert with utility classes)
.alert-sm {
  padding: 0.5rem 1rem;
  font-size: 0.875rem;
}

// ADDED: Responsive list group styles (moved from _animations.scss)
@media (max-width: 576px) {
  .list-group-item {
    .d-flex.flex-wrap {
      margin-bottom: 0.75rem !important;
    }
    .ms-4 { // Consider replacing with Bootstrap's margin utilities if possible
      margin-left: 1rem !important;
    }
    .badge {
      font-size: 0.75rem;
    }
  }
}

.g-md-4 {
  @include media-breakpoint-up(md) {
    --bs-gutter-x: 1.5rem;
    --bs-gutter-y: 1.5rem;
  }
}

.g-md-5 {
  @include media-breakpoint-up(md) {
    --bs-gutter-x: 3rem;
    --bs-gutter-y: 3rem;
  }
}